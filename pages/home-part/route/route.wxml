<!--pages/home-part/route/route.wxml-->
<view class="container">
  <!-- é¢„çº¦è·¯çº¿è¯¦æƒ…æ¨¡å¼ -->
  <block wx:if="{{fromReservation}}">
    <view class="header-bg">
      <view class="header-content">
        <text class="header-title">è·¯çº¿è¯¦æƒ…</text>
        <text class="header-subtitle">{{reservationRoute.licensePlate}}</text>
      </view>
    </view>
    <view class="content-area">
      <view class="reservation-route-card">
        <view class="route-detail-section">
          <view class="route-point-item">
            <view class="point-marker start">èµ·</view>
            <view class="point-content">
              <text class="point-label">èµ·ç‚¹</text>
              <text class="point-name">{{reservationRoute.startPoint}}</text>
            </view>
          </view>
          <view class="route-line-vertical"></view>
          <view class="route-point-item">
            <view class="point-marker end">ç»ˆ</view>
            <view class="point-content">
              <text class="point-label">ç»ˆç‚¹</text>
              <text class="point-name">{{reservationRoute.endPoint}}</text>
            </view>
          </view>
        </view>
        <view class="route-plan-section">
          <text class="plan-title">è§„åˆ’è·¯çº¿</text>
          <text class="plan-content">{{reservationRoute.plannedRoute || 'æš‚æ— è§„åˆ’è·¯çº¿'}}</text>
        </view>
        <view class="route-actions">
          <button class="action-btn-large primary" bindtap="startNavigation">
            <text class="btn-icon">ğŸ§­</text>
            <text>å¼€å§‹å¯¼èˆª</text>
          </button>
          <button class="action-btn-large secondary" bindtap="viewOnMap">
            <text class="btn-icon">ğŸ—ºï¸</text>
            <text>åœ°å›¾æŸ¥çœ‹</text>
          </button>
        </view>
      </view>
    </view>
  </block>

  <!-- è·¯çº¿åˆ—è¡¨æ¨¡å¼ -->
  <block wx:else>
  <!-- é¡¶éƒ¨èƒŒæ™¯ -->
  <view class="header-bg">
    <view class="header-content">
      <text class="header-title">å…¨éƒ¨è·¯çº¿</text>
      <text class="header-subtitle">é€‰æ‹©é€‚åˆçš„è¿è¾“è·¯çº¿</text>
    </view>
    <!-- æœç´¢æ¡† -->
    <view class="search-box">
      <view class="search-icon">ğŸ”</view>
      <input class="search-input" placeholder="æœç´¢è·¯çº¿åç§°" value="{{searchValue}}" bindinput="onSearch" />
      <view class="clear-btn" wx:if="{{searchValue}}" bindtap="onClearSearch">Ã—</view>
    </view>
  </view>

  <view class="content-area">
    <!-- åˆ†ç±»Tab -->
    <view class="tab-card">
      <view class="tab-bar">
        <view class="tab-item {{activeTab === 0 ? 'active' : ''}}" bindtap="onTabChange" data-index="0">
          <text>å…¨éƒ¨</text>
        </view>
        <view class="tab-item {{activeTab === 1 ? 'active' : ''}}" bindtap="onTabChange" data-index="1">
          <text>ğŸ§ª åŒ–å­¦å“</text>
        </view>
        <view class="tab-item {{activeTab === 2 ? 'active' : ''}}" bindtap="onTabChange" data-index="2">
          <text>ğŸ”¥ ç‡ƒæ°”</text>
        </view>
        <view class="tab-item {{activeTab === 3 ? 'active' : ''}}" bindtap="onTabChange" data-index="3">
          <text>âš¡ ç‰¹æ®Š</text>
        </view>
      </view>
    </view>
    
    <!-- è·¯çº¿åˆ—è¡¨ -->
    <scroll-view scroll-y class="route-list">
      <view class="route-card {{currentRouteId === item.id ? 'selected' : ''}}" 
            wx:for="{{filteredRoutes}}" wx:key="id" 
            bindtap="onRouteSelect" data-id="{{item.id}}">
        <view class="route-left">
          <view class="route-icon {{item.type || 'default'}}">
            {{item.type === 'chemical' ? 'ğŸ§ª' : item.type === 'gas' ? 'ğŸ”¥' : item.type === 'special' ? 'âš¡' : 'ğŸ“'}}
          </view>
          <view class="route-info">
            <view class="route-name-row">
              <text class="route-name">{{item.name}}</text>
              <view class="current-tag" wx:if="{{currentRouteId === item.id}}">å·²é€‰</view>
            </view>
            <text class="route-desc">{{item.desc}}</text>
            <view class="route-tags">
              <text class="route-tag distance">{{item.distance || '15km'}}</text>
              <text class="route-tag time">{{item.time || 'çº¦30åˆ†é’Ÿ'}}</text>
            </view>
          </view>
        </view>
        <view class="route-right">
          <button class="nav-btn" size="mini" catchtap="onNavigate" data-id="{{item.id}}">
            å¯¼èˆª
          </button>
        </view>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{filteredRoutes.length === 0}}">
        <view class="empty-icon">ğŸ”</view>
        <text class="empty-text">æ²¡æœ‰åŒ¹é…çš„è·¯çº¿</text>
        <button class="reset-btn" size="mini" bindtap="onResetFilter">é‡ç½®ç­›é€‰</button>
      </view>
    </scroll-view>
  </view>
  
  <!-- åº•éƒ¨ç¡®è®¤æ  -->
  <view class="bottom-bar" wx:if="{{currentRouteId}}">
    <view class="selected-info">
      <text class="selected-label">å·²é€‰æ‹©</text>
      <text class="selected-name">{{selectedRouteName}}</text>
    </view>
    <button class="confirm-btn" bindtap="onConfirmRoute">ç¡®è®¤é€‰æ‹©</button>
  </view>
  </block>
</view>
