<!--pages/home-part/map/map.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
  <view class="header-bar">
    <view class="header-left">
      <text class="header-title">å›­åŒºåœ°å›¾</text>
      <text class="update-time">æ›´æ–°: {{updateTime}}</text>
    </view>
    <view class="vehicle-count">
      <text class="count-value">{{filteredVehicleCount || 0}}</text>
      <text class="count-label">è¾†</text>
    </view>
  </view>
  
  <!-- ç­›é€‰æ  -->
  <view class="filter-container">
    <scroll-view scroll-x class="filter-scroll" enhanced show-scrollbar="{{false}}">
      <view class="filter-list">
        <view class="filter-item {{activeZone === item.value ? 'active' : ''}}" 
              wx:for="{{zoneTypes}}" wx:key="value" 
              bindtap="filterByZone" data-zone="{{item.value}}">
          <text>{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>
  
  <!-- åœ°å›¾åŒºåŸŸ -->
  <view class="map-container">
    <map id="map" class="map"
         longitude="{{longitude}}" 
         latitude="{{latitude}}" 
         scale="{{scale}}"
         markers="{{markers}}"
         polygons="{{polygons}}"
         show-location
         bindmarkertap="onMarkerTap" />
    
    <!-- åœ°å›¾æ§åˆ¶æŒ‰é’® -->
    <view class="map-controls">
      <view class="control-btn location" bindtap="centerLocation">
        <text>ğŸ“</text>
      </view>
      <view class="control-btn layers" bindtap="toggleZoneDisplay">
        <text>{{showZones ? 'ğŸ—ºï¸' : 'ğŸ“Š'}}</text>
      </view>
    </view>
    
    <!-- å›¾ä¾‹ -->
    <view class="map-legend">
      <view class="legend-item">
        <view class="legend-dot normal"></view>
        <text>æ™®é€šè½¦è¾†</text>
      </view>
      <view class="legend-item">
        <view class="legend-dot danger"></view>
        <text>å±é™©å“è½¦</text>
      </view>
    </view>
  </view>
  
  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <view class="action-item" bindtap="centerLocation">
      <view class="action-icon">ğŸ“</view>
      <text>å®šä½</text>
    </view>
    <view class="action-item" bindtap="refreshData">
      <view class="action-icon">ğŸ”„</view>
      <text>åˆ·æ–°</text>
    </view>
    <view class="action-item" bindtap="toggleZoneDisplay">
      <view class="action-icon">{{showZones ? 'ğŸ‘ï¸' : 'ğŸ™ˆ'}}</view>
      <text>{{showZones ? 'éšè—åŒºåŸŸ' : 'æ˜¾ç¤ºåŒºåŸŸ'}}</text>
    </view>
    <view class="action-item" bindtap="searchVehicle">
      <view class="action-icon">ğŸ”</view>
      <text>æœç´¢</text>
    </view>
  </view>
</view>
