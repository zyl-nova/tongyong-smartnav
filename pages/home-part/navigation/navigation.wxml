<!--pages/home-part/navigation/navigation.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨ç»Ÿè®¡æ  -->
  <view class="stats-header">
    <view class="stat-item">
      <text class="stat-value">{{dangerVehicleCount || 0}}</text>
      <text class="stat-label">å±é™©å“è½¦è¾†</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item warning">
      <text class="stat-value">{{warningCount || 0}}</text>
      <text class="stat-label">é¢„è­¦æ•°</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item danger">
      <text class="stat-value">{{accidentCount || 0}}</text>
      <text class="stat-label">äº‹æ•…æ•°</text>
    </view>
  </view>
  
  <!-- Tabåˆ‡æ¢ -->
  <view class="tab-container">
    <view class="tab-bar">
      <view class="tab-item {{activeTab === 'compare' ? 'active' : ''}}" bindtap="switchTab" data-tab="compare">
        <text>è·¯çº¿å¯¹æ¯”</text>
      </view>
      <view class="tab-item {{activeTab === 'planned' ? 'active' : ''}}" bindtap="switchTab" data-tab="planned">
        <text>é¢„å®šè·¯çº¿</text>
      </view>
      <view class="tab-item {{activeTab === 'actual' ? 'active' : ''}}" bindtap="switchTab" data-tab="actual">
        <text>å®é™…è·¯çº¿</text>
      </view>
    </view>
  </view>
  
  <!-- åœ°å›¾åŒºåŸŸ -->
  <view class="map-section">
    <map class="nav-map" 
         longitude="{{center.longitude}}" 
         latitude="{{center.latitude}}" 
         scale="13" 
         markers="{{markers}}" 
         polyline="{{polyline}}" />
    
    <!-- åœ°å›¾æ§åˆ¶æŒ‰é’® -->
    <view class="map-controls">
      <view class="control-btn" bindtap="centerLocation">
        <text>ğŸ“</text>
      </view>
      <view class="control-btn" bindtap="zoomIn">
        <text>+</text>
      </view>
      <view class="control-btn" bindtap="zoomOut">
        <text>-</text>
      </view>
    </view>
  </view>
  
  <!-- è½¦è¾†ä¿¡æ¯å¡ç‰‡ -->
  <view class="vehicle-card" wx:if="{{selectedVehicle}}">
    <view class="vehicle-header">
      <view class="vehicle-plate-tag">{{selectedVehicle.plateNumber}}</view>
      <view class="vehicle-status online">åœ¨çº¿</view>
    </view>
    <view class="vehicle-details">
      <view class="detail-row">
        <text class="detail-label">å¸æœº</text>
        <text class="detail-value">{{selectedVehicle.driver}}</text>
      </view>
      <view class="detail-row">
        <text class="detail-label">è´§ç‰©</text>
        <text class="detail-value">{{selectedVehicle.cargo}}</text>
      </view>
    </view>
    <view class="analysis-box" wx:if="{{selectedVehicle.deviationAnalysis}}">
      <text class="analysis-text">{{selectedVehicle.deviationAnalysis}}</text>
    </view>
  </view>
  
  <!-- é¢„è­¦ä¿¡æ¯ -->
  <view class="alerts-section" wx:if="{{alerts.length > 0}}">
    <view class="section-header">
      <view class="section-icon">âš ï¸</view>
      <text class="section-title">é¢„è­¦ä¿¡æ¯</text>
      <text class="alert-count">{{alerts.length}}</text>
    </view>
    <view class="alert-list">
      <view class="alert-card {{item.level}}" wx:for="{{alerts}}" wx:key="id">
        <view class="alert-header">
          <text class="alert-title">{{item.title}}</text>
          <text class="alert-time">{{item.time}}</text>
        </view>
        <text class="alert-content">{{item.content}}</text>
        <view class="alert-actions">
          <button class="action-btn confirm" size="mini" bindtap="handleAlert" data-id="{{item.id}}" data-action="confirm">ç¡®è®¤</button>
          <button class="action-btn dismiss" size="mini" bindtap="handleAlert" data-id="{{item.id}}" data-action="false">è¯¯æŠ¥</button>
        </view>
      </view>
    </view>
  </view>
</view>
