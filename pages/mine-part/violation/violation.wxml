<!--pages/mine-part/violation/violation.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨èƒŒæ™¯ -->
  <view class="header-bg">
    <view class="header-content">
      <text class="header-title">è¿è§„è®°å½•</text>
      <text class="header-subtitle">æŸ¥çœ‹è·¯çº¿åç¦»å’Œè¿è§„ä¿¡æ¯</text>
    </view>
  </view>

  <view class="content-area">
    <!-- è·¯çº¿åç¦»è­¦å‘Šå¡ç‰‡ -->
    <view class="warning-card" wx:if="{{routeInfo.isDeviated}}">
      <view class="warning-header">
        <view class="warning-icon">âš ï¸</view>
        <view class="warning-info">
          <text class="warning-title">è·¯çº¿åç¦»è­¦å‘Š</text>
          <text class="warning-distance">åç¦» {{routeInfo.deviationDistance}} km</text>
        </view>
      </view>
      <view class="warning-details">
        <view class="detail-row">
          <text class="detail-label">é¢„å®šè·¯çº¿</text>
          <text class="detail-value">{{routeInfo.plannedRoute}}</text>
        </view>
        <view class="detail-row">
          <text class="detail-label">å®é™…è·¯çº¿</text>
          <text class="detail-value highlight">{{routeInfo.actualRoute}}</text>
        </view>
        <view class="detail-row">
          <text class="detail-label">åç¦»æ—¶é—´</text>
          <text class="detail-value">{{routeInfo.deviationTime}}</text>
        </view>
      </view>
    </view>

    <!-- æ— è¿è§„æç¤º -->
    <view class="success-card" wx:if="{{!routeInfo.isDeviated && violations.length === 0}}">
      <view class="success-icon">âœ“</view>
      <text class="success-text">æ‚¨çš„é©¾é©¶è®°å½•è‰¯å¥½</text>
      <text class="success-hint">æš‚æ— è¿è§„è®°å½•</text>
    </view>

    <!-- åœ°å›¾åŒºåŸŸ -->
    <view class="map-card" wx:if="{{routeInfo.isDeviated}}">
      <view class="card-header">
        <text class="card-icon">ğŸ—ºï¸</text>
        <text class="card-title">è·¯çº¿å¯¹æ¯”</text>
      </view>
      <view class="map-container">
        <map 
          class="violation-map" 
          longitude="{{routeInfo.centerLongitude}}" 
          latitude="{{routeInfo.centerLatitude}}" 
          scale="13" 
          markers="{{markers}}" 
          polyline="{{polyline}}" 
          show-location 
        />
        <view class="map-legend">
          <view class="legend-item">
            <view class="legend-line planned"></view>
            <text>é¢„å®šè·¯çº¿</text>
          </view>
          <view class="legend-item">
            <view class="legend-line actual"></view>
            <text>å®é™…è·¯çº¿</text>
          </view>
        </view>
      </view>
    </view>

    <!-- è¿è§„è®°å½•åˆ—è¡¨ -->
    <view class="section-card" wx:if="{{violations.length > 0}}">
      <view class="card-header">
        <text class="card-icon">ğŸ“‹</text>
        <text class="card-title">è¿è§„è®°å½•</text>
        <text class="card-count">{{violations.length}}æ¡</text>
      </view>
      <view class="violation-list">
        <view class="violation-item" wx:for="{{violations}}" wx:key="id">
          <view class="violation-header">
            <view class="violation-type {{item.level || 'normal'}}">{{item.type}}</view>
            <text class="violation-time">{{item.time}}</text>
          </view>
          <text class="violation-desc">{{item.description}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
